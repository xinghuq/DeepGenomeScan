<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Calculating q-values from importance values
 — DLqvalues • DeepGenomeScan</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Calculating q-values from importance values
 — DLqvalues" />

<meta property="og:description" content="The 
" />





<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-158177382-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-158177382-1');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DeepGenomeScan</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/home.html">Home</a>
</li>
<li>
  <a href="../articles/index.html">Tutorials</a>
</li>
<li>
  <a href="../reference/index.html">Manual</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/xinghuq/DeepGenomeScan/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculating q-values from importance values
<!-- %%  ~~function to do ... ~~ --></h1>
    
    <div class="hidden name"><code>DLqvalues.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>The 
<!-- %%  ~~ A concise (1-5 lines) description of what the function does. ~~ --></p>
    
    </div>

    <pre class="usage"><span class='fu'>DLqvalues</span><span class='op'>(</span><span class='va'>DL_data</span>, <span class='va'>K</span>, estimation<span class='op'>=</span><span class='st'>"auto"</span><span class='op'>)</span></pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>DL_data</th>
      <td><p>The variable importance. Row names are variable names, columns are the importance obtained from indenpendent factors
<!-- %%     ~~Describe \code{DL_data} here~~ --></p></td>
    </tr>
    <tr>
      <th>K</th>
      <td><p>The degrees of freedom (non-negative, but can be non-integer) used in estimating the q-values.
<!-- %%     ~~Describe \code{K} here~~ --></p></td>
    </tr>
    <tr>
      <th>estimation</th>
      <td><p>The estimation method. A character string specifying the robust estimator to be used. The choices are: "mcd" for the Fast MCD algorithm of Rousseeuw and Van Driessen, "weighted" for the Reweighted MCD, "donostah" for the Donoho-Stahel projection based estimator, "M" for the constrained M estimator provided by Rocke, "pairwiseQC" for the orthogonalized quadrant correlation pairwise estimator, and "pairwiseGK" for the Orthogonalized Gnanadesikan-Kettenring pairwise estimator. The default "auto" selects from "donostah", "mcd", and "pairwiseQC" with the goal of producing a good estimate in a reasonable amount of time.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The covRob function selects a robust covariance estimator that is likely to provide a good estimate in a reasonable amount of time. Presently this selection is based on the problem size. The Donoho-Stahel estimator is used if there are less than 1000 observations and less than 10 variables or less than 5000 observations and less than 5 variables. If there are less than 50000 observations and less than 20 variables then the MCD is used. For larger problems, the Orthogonalized Quadrant Correlation estimator is used.</p>
<p>The MCD and Reweighted-MCD estimates (estim = "mcd" and estim = "weighted" respectively) are computed using the covMcd function in the robustbase package. By default, covMcd returns the reweighted estimate; the actual MCD estimate is contained in the components of the output list prefixed with raw.</p>
<p>The M estimate (estim = "M") is computed using the covMest function in the rrcov package. For historical reasons the Robust Library uses the MCD to compute the initial estimate.</p>
<p>The Donoho-Stahel (estim = "donostah") estimator is computed using the CovSde function provided in the rrcov package.</p>
<p>The pairwise estimators (estim = "pairwisegk" and estim = "pairwiseqc") are computed using the CovOgk function in the rrcov package.</p>
<p>Version 0.3-8 of the Robust Library: all of the functions origianlly contributed by the S-Plus Robust Library have been replaced by dependencies on the robustbase and rrcov packages. Computed results may differ from earlier versions of the Robust Library. In particular, the MCD estimators are now adjusted by a small sample size correction factor. Additionally, a bug was fixed where the final MCD covariance estimate produced with estim = "mcd" was not rescaled for consistency.
<!-- %%  ~~ If necessary, more details than the description above ~~ --></p>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Results return p-values and q-values for variables
<!-- %%  ~Describe the value returned -->
<!-- %%  If it is a LIST, use -->
<!-- %%  \item{comp1 }{Description of 'comp1'} -->
<!-- %%  \item{comp2 }{Description of 'comp2'} -->
<!-- %% ... --></p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>R. A. Maronna and V. J. Yohai (1995) The Behavior of the Stahel-Donoho Robust Multivariate Estimator. Journal of the American Statistical Association 90 (429), 330–341.</p>
<p>P. J. Rousseeuw and K. van Driessen (1999) A fast algorithm for the minimum covariance determinant estimator. Technometrics 41, 212–223.</p>
<p>D. L. Woodruff and D. M. Rocke (1994) Computable robust estimation of multivariate location and shape on high dimension using compound estimators. Journal of the American Statistical Association, 89, 888–896.</p>
<p>R. A. Maronna and R. H. Zamar (2002) Robust estimates of location and dispersion of high-dimensional datasets. Technometrics 44 (4), 307–317.</p>
<p><!-- %% ~put references to the literature/web site here ~ --></p>
    
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p><!-- %%  ~~who you are~~ --></p>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p><!-- %%  ~~further notes~~ --></p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><!-- %% ~~objects to See Also as \code{\link{help}}, ~~~ --></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>##---- Should be DIRECTLY executable !! ----</span>
<span class='co'>##-- ==&gt;  Define data, use random,</span>
<span class='co'>##--  or do  help(data=index)  for the standard data sets.</span>

<span class='co'>## The function is currently defined as</span>
<span class='kw'>function</span> <span class='op'>(</span><span class='va'>DL_data</span>, <span class='va'>K</span><span class='op'>)</span> 
<span class='op'>{</span>
    <span class='va'>loadings</span> <span class='op'>&lt;-</span> <span class='va'>DL_data</span>
    <span class='va'>resscale</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='va'>loadings</span>, <span class='fl'>2</span>, <span class='va'>scale</span><span class='op'>)</span>
    <span class='va'>resmaha</span> <span class='op'>&lt;-</span> <span class='fu'>covRob</span><span class='op'>(</span><span class='va'>resscale</span>, distance <span class='op'>=</span> <span class='cn'>TRUE</span>, na.action <span class='op'>=</span> <span class='va'>na.omit</span>, 
        estim <span class='op'>=</span> <span class='st'>"donostah"</span><span class='op'>)</span><span class='op'>$</span><span class='va'>dist</span>
    <span class='va'>lambda</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/median.html'>median</a></span><span class='op'>(</span><span class='va'>resmaha</span><span class='op'>)</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/stats/Chisquare.html'>qchisq</a></span><span class='op'>(</span><span class='fl'>0.5</span>, df <span class='op'>=</span> <span class='va'>K</span><span class='op'>)</span>
    <span class='va'>reschi2test</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Chisquare.html'>pchisq</a></span><span class='op'>(</span><span class='va'>resmaha</span><span class='op'>/</span><span class='va'>lambda</span>, <span class='va'>K</span>, lower.tail <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
    <span class='va'>qval</span> <span class='op'>&lt;-</span> <span class='fu'>qvalue</span><span class='op'>(</span><span class='va'>reschi2test</span><span class='op'>)</span>
    <span class='va'>q.values_DL</span> <span class='op'>&lt;-</span> <span class='va'>qval</span><span class='op'>$</span><span class='va'>qvalues</span>
    <span class='va'>padj</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/p.adjust.html'>p.adjust</a></span><span class='op'>(</span><span class='va'>reschi2test</span>, method <span class='op'>=</span> <span class='st'>"bonferroni"</span><span class='op'>)</span>
    <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>p.values <span class='op'>=</span> <span class='va'>reschi2test</span>, q.values <span class='op'>=</span> <span class='va'>q.values_DL</span>, 
        padj <span class='op'>=</span> <span class='va'>padj</span><span class='op'>)</span><span class='op'>)</span>
  <span class='op'>}</span>
</div><div class='output co'>#&gt; function (DL_data, K) 
#&gt; {
#&gt;     loadings &lt;- DL_data
#&gt;     resscale &lt;- apply(loadings, 2, scale)
#&gt;     resmaha &lt;- covRob(resscale, distance = TRUE, na.action = na.omit, 
#&gt;         estim = "donostah")$dist
#&gt;     lambda &lt;- median(resmaha)/qchisq(0.5, df = K)
#&gt;     reschi2test &lt;- pchisq(resmaha/lambda, K, lower.tail = FALSE)
#&gt;     qval &lt;- qvalue(reschi2test)
#&gt;     q.values_DL &lt;- qval$qvalues
#&gt;     padj &lt;- p.adjust(reschi2test, method = "bonferroni")
#&gt;     return(data.frame(p.values = reschi2test, q.values = q.values_DL, 
#&gt;         padj = padj))
#&gt;   }
#&gt; &lt;environment: 0xba5d778&gt;</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Xinghu Qin.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


